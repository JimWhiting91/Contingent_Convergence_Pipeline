# Contingent Convergence Pipeline
Full pipeline employing slim to investigate the effects of variable demographic parameters on genetic measures of population differentiation in adaptation and convergence

## Issues
Please report any issues to j.whiting2@exeter.ac.uk or post in the Issues tab

## SLiM 3 software
This pipeline uses the forward simulation software SLiM 3 (Haller and Messer 2019) to perform all simulations. 

SLiM can be downloaded [here](https://messerlab.org/slim/).

This pipeline employs the command-line version of SLiM 3, however a GUI is provided which aids in interpretation and visualising simulations.

## To run
**Data processing**
* Download the entire folder to your system using the `Clone` or `download` button.
* Ensure the folder structure and folder names are unchanged.
* The pipeline is run through a single script (`scripts/slim_master.sh`).
* Edit the variables at the top of the script to include the working directory, GFF path, population size, mutation rate, and output directory.

**The pipeline**
* The pipeline runs by modifying the SLiM template txt files in the scripts directory to create full SLiM scripts to run.
* For each iteration of the simulation, a directory is made in which all SLiM scripts are written and temporary files are stored.
* `scripts/build_a_SLIM_gene.sh` uses a GFF to build custom genes that distinguish each iteration of the simulation.
* Firstly, a burn-in script is created and run to generate an ancestral population with genetic and phenotypic variation.
* Then, the 32 demographic treatment scripts are written and run using GNU parallel.
* Outputs are combined to a single file which is exported to the user-defined output directory, along with the template script for the gene output by `scripts/build_a_SLIM_gene.sh` (this allows the same gene to be run again if necessary).
* The temporary directory for each gene is removed following final output.

**Analysis**
* All analyses, outputs and figures are generated by the `scripts/analyse_slim_outputs.R script`.
* This script takes all pipeline outputs from the user-defined output directory, combines them, and performs the full analysis.

## References
Haller, B. C., & Messer, P. W. (2019). SLiM 3: Forward genetic simulations beyond the Wrightâ€“Fisher model. Molecular biology and evolution, 36(3), 632-637.
